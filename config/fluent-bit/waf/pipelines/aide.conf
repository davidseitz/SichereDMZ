# -------------------------------------------------------------------
# AIDE INTEGRITY CHECK PIPELINE
# -------------------------------------------------------------------

# 1. INPUT: Read the flattened JSON file
[INPUT]
    Name             tail
    Path             /var/log/aide.json
    Tag              security.aide
    Read_from_Head   True

# 2. FILTER: Unpack the JSON string
[FILTER]
    Name             parser
    Match            security.aide
    Key_Name         log
    Parser           aide_json_parser
    Reserve_Data     On

# 3. OUTPUT: Ship to Loki
[OUTPUT]
    Name             loki
    Match            security.aide
    Host             10.10.30.2

    # --- Authentication for Nginx ---
    http_user        loki-user
    http_passwd      a_secretPW#15secEt
    # --------------------------------


    Port             3100
    Labels           job=aide, host=waf_debian
    Line_Format      json
