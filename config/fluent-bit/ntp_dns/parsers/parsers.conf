[PARSER]
    Name        aide_json_parser
    Format      json
    Time_Key    start_time
    Time_Format %Y-%m-%d %H:%M:%S %z

[PARSER]
    Name        coredns_regex
    Format      regex
    Regex       ^\[(?<level>[^\]]+)\]\s+(?<remote_ip>[^:]+):(?<remote_port>\d+)\s+-\s+(?<id>\d+)\s+"(?<type>\S+)\s+(?<class>\S+)\s+(?<name>\S+)\s+(?<proto>\S+)\s+(?<req_size>\d+)\s+(?<do>\S+)\s+(?<bufsize>\d+)"\s+(?<rcode>\S+)\s+(?<flags>\S+)\s+(?<resp_size>\d+)\s+(?<duration>[\d\.]+)s$
    # No Time_Key available in the log line itself, so we use ingestion time.
    Types       id:integer remote_port:integer req_size:integer resp_size:integer duration:float
