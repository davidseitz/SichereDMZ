# AIDE Configuration for OWASP/Nginx WAF
# SIMPLIFIED: No Compression

# --- System Settings ---
@@x_include_setenv UPAC_settingsd /etc/aide/aide.settings.d
@@x_include_setenv PATH /bin:/usr/bin:/sbin:/usr/sbin

# Database Locations (PLAIN TEXT)
database_in=file:/var/lib/aide/aide.db
database_out=file:/var/lib/aide/aide.db.new
database_new=file:/var/lib/aide/aide.db.new
gzip_dbout=no

# --- Reporting (JSON to Stdout) ---
report_format = json
report_url = stdout

# --- Groups / Macros ---
Checksums = sha512
OwnerMode = p+u+g+ftype
Size = s+b
InodeData = OwnerMode+n+i+Size+l+X
StaticFile = m+c+Checksums
Full = InodeData+StaticFile
VarFile = OwnerMode+n+l+X

# --- 1. CORE SYSTEM INTEGRITY ---
/boot   Full
/bin    Full
/sbin   Full
/lib    Full
/lib64  Full
/usr/bin    Full
/usr/sbin   Full
/usr/lib    Full
/opt        Full
/root       Full

# --- 2. WAF & NGINX SPECIFIC PROTECTION ---
/etc/nginx/nginx.conf  Full
/etc/nginx/conf.d      Full
/etc/nginx/conf.d/waf_conf Full
/etc/modsecurity.d     Full
/etc/modsecurity       Full
/usr/share/nginx/html  Full

# --- 3. CONFIGURATION & NETWORK ---
/etc    Full
/etc/resolv.conf Full
/etc/hosts Full
/etc/hostname Full

!/etc/mtab
!/etc/ld.so.cache
!/etc/alternatives

/etc/ssh/sshd_config   Full
!/etc/ssh/ssh_host_*_key
!/etc/ssh/ssh_host_*_key.pub

# --- 4. ADMIN & OPERATIONS ---
/home/admin  Full
!/home/admin/.ssh/known_hosts
/start_waf.sh Full
/docker-entrypoint.sh Full

# Protect the AIDE Database itself (No .gz extension now)
/var/lib/aide/aide.db StaticFile

# --- 5. EXCLUSIONS ---
!/var/log/nginx
!/var/log/modsec_audit.log
!/var/log/ssh-custom.log
!/var/log/aide.json
!/var/log/aide.log
!/var/log/lastlog
!/var/log/wtmp
!/var/log/btmp
!/var/run
!/run
!/var/tmp
!/tmp
!/proc
!/sys
!/dev
!/var/cache
!/var/lock
